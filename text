import yfinance as yf
import pandas as pd
from datetime import datetime

# Define stock tickers
tickers = {
    "NIFTY50": "^NSEI",        # Nifty Index
    "RELIANCE": "RELIANCE.NS",
    "TCS": "TCS.NS",
    "INFOSYS": "INFY.NS"
}

# Date range
start_date = "2024-01-01"
end_date = datetime.today().strftime("%Y-%m-%d")

# Empty list for clean records
records = []

for name, ticker in tickers.items():
    stock = yf.download(ticker, start=start_date, end=end_date, interval="1d")
    
    stock.reset_index(inplace=True)   # reset index (Date)
    stock["Company"] = name           # add stock name
    
    # Rename columns for clarity
    stock.rename(columns={
        "Date": "TradeDate",
        "Open": "OpenPrice",
        "High": "HighPrice",
        "Low": "LowPrice",
        "Close": "ClosePrice",
        "Adj Close": "AdjClosePrice",
        "Volume": "TradeVolume"
    }, inplace=True)
    
    # Reorder columns
    stock = stock[["TradeDate", "Company", "OpenPrice", "HighPrice", "LowPrice", "ClosePrice", "AdjClosePrice", "TradeVolume"]]
    
    records.append(stock)

# Combine all stocks into one clean DataFrame
df = pd.concat(records, ignore_index=True)

# Save to CSV
df.to_csv("DailyStockData.csv", index=False)

print("âœ… Clean daily stock data saved as DailyStockData.csv")
print(df.head(10))
