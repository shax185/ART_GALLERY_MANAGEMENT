import pandas as pd

# Load your enriched dataset
df = pd.read_csv("reliance_enriched.csv")

# 1. Convert TradeDate to proper ISO format (YYYY-MM-DD)
df["TradeDate"] = pd.to_datetime(df["TradeDate"], format="%d-%m-%Y").dt.strftime("%Y-%m-%d")

# 2. Ensure numeric types are correct
numeric_cols = [
    "OpenPrice", "HighPrice", "LowPrice", "ClosePrice", "AdjClose",
    "TradeVolume", "DailyReturnPct", "PriceRange", 
    "Volatility_7d", "SMA7", "SMA30", "Vol_MA7"
]
for col in numeric_cols:
    df[col] = pd.to_numeric(df[col], errors="coerce")

# 3. Convert boolean VolumeSpike into integer (0/1) for SQL
df["VolumeSpike"] = df["VolumeSpike"].astype(int)

# Save cleaned version
df.to_csv("reliance_sql_ready.csv", index=False)

print("âœ… Data cleaned and ready for SQL import!")
