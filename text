import pandas as pd
from sqlalchemy import create_engine

# --- 1. Paths & Connection Details ---
sqlite_path = "database.sqlite"  # path to your Kaggle SQLite file
postgres_user = "postgres"
postgres_password = "your_password"
postgres_host = "localhost"
postgres_port = "5432"
postgres_db = "football_raw"

# --- 2. Connect to SQLite ---
sqlite_engine = create_engine(f"sqlite:///{sqlite_path}")

# --- 3. Connect to PostgreSQL ---
pg_engine = create_engine(f"postgresql+psycopg2://{postgres_user}:{postgres_password}@{postgres_host}:{postgres_port}/{postgres_db}")

# --- 4. Get all table names from SQLite ---
sqlite_tables = sqlite_engine.table_names()

# --- 5. Migrate each table ---
for table in sqlite_tables:
    print(f"Transferring {table}...")
    df = pd.read_sql_table(table, sqlite_engine)
    df.to_sql(table, pg_engine, if_exists='replace', index=False)

print("âœ… Migration completed: All tables moved to PostgreSQL!")
